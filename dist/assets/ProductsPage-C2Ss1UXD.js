import{d as A,j as e,L as k,e as H,b as $,a as E,r as h,c as R}from"./index-D-IP5-lX.js";import{H as b,F as j}from"./Footer-BCAYlC8H.js";import{e as _,h as T,i as z}from"./index-DayB5pOv.js";import{c as O,f as S}from"./formatPrice-llLTZHwJ.js";const D=({product:s})=>{const{addToCart:p,error:c}=A(),u=async l=>{l.preventDefault(),l.stopPropagation();const r=await p(s);!r&&c==="Please log in to add items."?alert("Please log in to add items to your cart."):r||alert(`Failed to add item: ${c||"Unknown error"}`)},N=O(s.mrp,s.price);return e.jsx(k,{to:`/product/${s.id}`,className:"group",children:e.jsxs("div",{className:"card-hover p-0 overflow-hidden flex flex-col h-full",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("img",{src:s.images[0],alt:s.name,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-500"}),s.isBestSeller&&e.jsx("span",{className:"bestseller-badge",children:"Bestseller"}),s.isOnSale&&N>0&&e.jsxs("span",{className:"discount-badge",children:[N,"% OFF"]}),e.jsxs("span",{className:`absolute bottom-3 left-3 px-2 py-0.5 rounded-full text-2xs font-medium backdrop-blur-sm ${s.soundLevel==="Low"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/20":s.soundLevel==="Medium"?"bg-gold/20 text-gold border border-gold/20":"bg-accent/20 text-accent border border-accent/20"}`,children:[s.soundLevel," Sound"]})]}),e.jsxs("div",{className:"p-5 flex flex-col flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-white line-clamp-2 flex-1 mb-3 group-hover:text-accent transition-colors duration-300",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((l,r)=>e.jsx(_,{size:10,className:r<Math.floor(s.rating)?"text-gold":"text-surface-700"},r))}),e.jsxs("span",{className:"text-2xs text-surface-500",children:["(",s.reviewCount,")"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"price text-lg",children:S(s.price)}),e.jsx("span",{className:"price-original",children:S(s.mrp)})]}),e.jsxs("button",{onClick:u,disabled:s.stock===0,className:`w-full py-2.5 rounded-xl text-sm font-semibold flex items-center justify-center gap-2 transition-all duration-300 ${s.stock===0?"bg-surface-700 text-surface-500 cursor-not-allowed":"bg-accent/10 text-accent border border-accent/20 hover:bg-accent hover:text-white hover:border-accent"}`,children:[e.jsx(T,{size:12}),e.jsx("span",{children:s.stock===0?"Sold Out":"Add to Cart"})]})]})]})})},K=()=>{const{categoryId:s}=H(),{products:p,isLoading:c,error:u}=$(),{categories:N,isLoading:l,error:r,getCategoryById:F}=E(),[g,v]=h.useState("name"),[o,C]=h.useState({min:0,max:1e3}),[d,y]=h.useState(""),[I,M]=h.useState(!1),i=!l&&s?F(s):null,x=p,m=h.useMemo(()=>{if(c)return[];let f=(s?x.filter(a=>typeof a.categoryId=="object"&&a.categoryId!==null&&"_id"in a.categoryId?a.categoryId._id===s:a.categoryId===s):x).filter(a=>{const n=a.price>=o.min&&a.price<=o.max,B=!d||a.soundLevel===d;return n&&B});return f.sort((a,n)=>{switch(g){case"name":return a.name.localeCompare(n.name);case"price":return a.price-n.price;case"price-desc":return n.price-a.price;case"rating":return n.rating-a.rating;default:return 0}}),f},[x,s,g,o,d,c]),L=()=>{v("name"),C({min:0,max:1e3}),y("")};if(c||l)return e.jsxs("div",{className:"min-h-screen bg-surface-900 flex flex-col",children:[e.jsx(b,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center pt-16",children:e.jsx(R,{text:"Loading products..."})}),e.jsx(j,{})]});if(u||r)return e.jsxs("div",{className:"min-h-screen bg-surface-900 flex flex-col",children:[e.jsx(b,{}),e.jsx("div",{className:"flex-1 section-container px-6 pt-28 text-center",children:e.jsx("p",{className:"text-accent",children:u||r})}),e.jsx(j,{})]});if(s&&!i&&!l)return e.jsxs("div",{className:"min-h-screen bg-surface-900 flex flex-col",children:[e.jsx(b,{}),e.jsxs("div",{className:"flex-1 section-container px-6 pt-28 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-white/[0.04] flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:"ðŸ“¦"})}),e.jsx("h1",{className:"text-xl font-semibold text-white mb-2",children:"Category Not Found"}),e.jsx("p",{className:"body-sm mb-6",children:"The category you requested does not exist."}),e.jsx(k,{to:"/shop",className:"btn-primary",children:"Back to Shop"})]}),e.jsx(j,{})]});const w=s&&i&&m.length===0&&x.some(t=>typeof t.categoryId=="object"&&t.categoryId!==null&&"_id"in t.categoryId?t.categoryId._id===s:t.categoryId===s),P=!s&&m.length===0&&x.length>0;return e.jsxs("div",{className:"min-h-screen bg-surface-900 flex flex-col",children:[e.jsx(b,{}),e.jsxs("div",{className:"flex-1 section-container px-6 pt-24 pb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("p",{className:"label mb-3",children:i?"Category":"All Products"}),e.jsx("h1",{className:"heading-md mb-3",children:i?.name||e.jsxs("span",{children:["All ",e.jsx("span",{className:"text-gradient",children:"Products"})]})}),e.jsx("p",{className:"body-md max-w-lg mx-auto mb-4",children:i?.description||"Browse our complete collection of premium crackers."}),e.jsxs("span",{className:"badge-accent",children:[m.length," products found"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>M(!I),className:"btn-ghost text-xs lg:hidden",children:[e.jsx(z,{size:12})," Filters"]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2",children:[{value:"name",label:"Name"},{value:"price",label:"Price â†‘"},{value:"price-desc",label:"Price â†“"},{value:"rating",label:"Rating"}].map(t=>e.jsx("button",{onClick:()=>v(t.value),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-300 ${g===t.value?"bg-accent text-white":"bg-white/[0.04] text-surface-400 border border-white/[0.06] hover:bg-white/[0.08] hover:text-white"}`,children:t.label},t.value))})]}),e.jsx("div",{className:"flex items-center gap-2",children:["","Low","Medium","High"].map(t=>e.jsx("button",{onClick:()=>y(t),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-300 ${d===t?"bg-accent text-white":"bg-white/[0.04] text-surface-400 border border-white/[0.06] hover:bg-white/[0.08] hover:text-white"}`,children:t||"All"},t))})]}),e.jsxs("div",{className:"flex gap-8",children:[e.jsx("div",{className:"hidden lg:block w-64 flex-shrink-0",children:e.jsxs("div",{className:"card p-6 sticky top-24",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-6",children:"Filters"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-xs font-semibold text-surface-400 uppercase tracking-wider mb-2",children:"Sort By"}),e.jsxs("select",{value:g,onChange:t=>v(t.target.value),className:"input text-sm",children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"price",children:"Price: Low to High"}),e.jsx("option",{value:"price-desc",children:"Price: High to Low"}),e.jsx("option",{value:"rating",children:"Rating"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-xs font-semibold text-surface-400 uppercase tracking-wider mb-2",children:"Max Price"}),e.jsxs("p",{className:"text-sm text-accent font-medium mb-2",children:["â‚¹0 â€” â‚¹",o.max]}),e.jsx("input",{type:"range",min:"0",max:"1000",step:"10",value:o.max,onChange:t=>C(f=>({...f,max:parseInt(t.target.value)})),className:"w-full accent-accent"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-xs font-semibold text-surface-400 uppercase tracking-wider mb-2",children:"Sound Level"}),e.jsxs("select",{value:d,onChange:t=>y(t.target.value),className:"input text-sm",children:[e.jsx("option",{value:"",children:"All Levels"}),e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Mixed",children:"Mixed"})]})]}),e.jsx("button",{onClick:L,className:"btn-secondary w-full text-xs py-2.5",children:"Clear Filters"})]})}),e.jsx("div",{className:"flex-1",children:m.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5",children:m.map(t=>e.jsx(D,{product:t},t.id))}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-white/[0.04] flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:"ðŸ“¦"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:w?`No Products in ${i?.name}`:P?"No Products":"No Products Match"}),e.jsx("p",{className:"body-sm mb-6",children:w||P?"Check back later or browse other categories.":"Try adjusting your filters."}),w||P?e.jsx(k,{to:"/shop",className:"btn-primary",children:"Browse Categories"}):e.jsx("button",{onClick:L,className:"btn-primary",children:"Clear Filters"})]})})]})]}),e.jsx(j,{})]})};export{K as default};
