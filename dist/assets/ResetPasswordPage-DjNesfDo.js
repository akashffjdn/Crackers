import{e as S,g as k,i as C,r as t,j as e,L as h,c as F,h as E}from"./index-D-IP5-lX.js";import{ai as R,E as b,G as y}from"./index-DayB5pOv.js";import{H as L,F as H}from"./Footer-BCAYlC8H.js";import{v as I}from"./validation-BaCAAAy9.js";const z=()=>{const{token:m}=S(),j=k(),{login:_}=C(),[o,x]=t.useState(""),[u,p]=t.useState(""),[d,v]=t.useState(!1),[n,N]=t.useState(!1),[w,f]=t.useState(!1),[i,g]=t.useState(""),[l,a]=t.useState(""),P=async r=>{if(r.preventDefault(),g(""),a(""),!m){a("Invalid or missing reset token.");return}if(o!==u){a("Passwords do not match");return}const c=I(o);if(!c.isValid){a(c.errors);return}f(!0);try{const s=await E.put(`/auth/reset-password/${m}`,{password:o});g(s.data.message||"Password reset successfully!"),s.data.token&&s.data.user?(localStorage.setItem("crackers_user_token",s.data.token),localStorage.setItem("crackers_user_profile",JSON.stringify(s.data.user)),alert("Password reset! Redirecting to login..."),j("/login")):(x(""),p(""))}catch(s){console.error("Reset password error:",s),a(s.response?.data?.message||s.message||"Failed to reset password. The link may be invalid or expired.")}finally{f(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(L,{}),e.jsx("div",{className:"flex-grow flex items-center justify-center py-16 px-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(R,{className:"text-4xl text-red-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Password"}),e.jsx("p",{className:"text-gray-600",children:"Enter your new password below."})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8",children:[i&&e.jsxs("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",role:"alert",children:[i,e.jsx("div",{className:"mt-2",children:e.jsx(h,{to:"/login",className:"font-medium text-green-800 hover:underline",children:"Proceed to Login"})})]}),l&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",role:"alert",children:Array.isArray(l)?e.jsx("ul",{className:"list-disc list-inside text-sm",children:l.map((r,c)=>e.jsx("li",{children:r},c))}):l}),!i&&e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:d?"text":"password",value:o,onChange:r=>x(r.target.value),required:!0,autoComplete:"new-password",className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500","aria-describedby":"password-constraints-reset"}),e.jsx("button",{type:"button",onClick:()=>v(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600","aria-label":d?"Hide password":"Show password",children:d?e.jsx(b,{}):e.jsx(y,{})})]}),e.jsx("p",{id:"password-constraints-reset",className:"text-xs text-gray-500 mt-1",children:"Min. 8 characters, incl. uppercase, lowercase, number."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:n?"text":"password",value:u,onChange:r=>p(r.target.value),required:!0,autoComplete:"new-password",className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"}),e.jsx("button",{type:"button",onClick:()=>N(!n),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600","aria-label":n?"Hide confirm password":"Show confirm password",children:n?e.jsx(b,{}):e.jsx(y,{})})]})]}),e.jsx("button",{type:"submit",disabled:w,className:"w-full flex justify-center items-center bg-gradient-to-r from-red-600 to-orange-600 text-white py-3 px-4 rounded-md font-semibold hover:from-red-700 hover:to-orange-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:w?e.jsx(F,{size:"sm",color:"text-white"}):"Reset Password"})]}),!i&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Remembered it?"," ",e.jsx(h,{to:"/login",className:"font-medium text-red-600 hover:text-red-500",children:"Sign in"})]})})]})]})}),e.jsx(H,{})]})};export{z as default};
