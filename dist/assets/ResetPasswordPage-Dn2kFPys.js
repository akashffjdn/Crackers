import{e as k,g as C,i as F,r as a,j as e,L as b,c as R,h as E}from"./index-vjTx7X_X.js";import{aj as L,g as A,a as x,J as j,K as y}from"./index-C8lrwkSk.js";import{H,F as I}from"./Footer-SUEj5nCx.js";import{v as _}from"./validation-BaCAAAy9.js";const M=()=>{const{token:m}=k(),v=C(),{login:q}=F(),[o,u]=a.useState(""),[p,h]=a.useState(""),[l,N]=a.useState(!1),[n,P]=a.useState(!1),[f,g]=a.useState(!1),[i,w]=a.useState(""),[d,t]=a.useState(""),S=async r=>{if(r.preventDefault(),w(""),t(""),!m){t("Invalid or missing reset token.");return}if(o!==p){t("Passwords do not match");return}const c=_(o);if(!c.isValid){t(c.errors);return}g(!0);try{const s=await E.put(`/auth/reset-password/${m}`,{password:o});w(s.data.message||"Password reset successfully!"),s.data.token&&s.data.user?(localStorage.setItem("crackers_user_token",s.data.token),localStorage.setItem("crackers_user_profile",JSON.stringify(s.data.user)),alert("Password reset! Redirecting to login..."),v("/login")):(u(""),h(""))}catch(s){console.error("Reset password error:",s),t(s.response?.data?.message||s.message||"Failed to reset password. The link may be invalid or expired.")}finally{g(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50 flex flex-col",children:[e.jsx(H,{}),e.jsxs("div",{className:"flex-grow flex items-center justify-center py-16 px-4 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-20 left-10 text-6xl opacity-10 animate-pulse-slow",children:"ðŸŽ†"}),e.jsx("div",{className:"absolute bottom-20 right-10 text-6xl opacity-10 animate-pulse-slow",style:{animationDelay:"1s"},children:"ðŸŽ‡"})]}),e.jsxs("div",{className:"max-w-md w-full space-y-8 relative z-10",children:[e.jsxs("div",{className:"text-center animate-fade-in",children:[e.jsxs("div",{className:"inline-block relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-red-200 rounded-full blur-xl opacity-50"}),e.jsx("div",{className:"relative bg-gradient-to-br from-red-100 to-orange-100 rounded-full p-4",children:e.jsx(L,{className:"text-5xl text-red-600 mx-auto"})})]}),e.jsx("h2",{className:"text-4xl font-bold font-display text-gray-900 mb-2",children:"Reset Password"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Enter your new password below."})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/50 animate-slide-up",children:[i&&e.jsxs("div",{className:"bg-green-50 border-l-4 border-green-500 text-green-700 px-6 py-4 rounded-xl mb-6 animate-slide-down",role:"alert",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(A,{className:"text-xl"}),e.jsx("span",{className:"font-semibold",children:i})]}),e.jsxs(b,{to:"/login",className:"inline-flex items-center space-x-2 text-green-800 hover:text-green-900 font-semibold group",children:[e.jsx("span",{children:"Proceed to Login"}),e.jsx(x,{className:"text-xs group-hover:translate-x-1 transition-transform"})]})]}),d&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-700 px-6 py-4 rounded-xl mb-6 animate-slide-down",role:"alert",children:Array.isArray(d)?e.jsx("ul",{className:"list-disc list-inside text-sm space-y-1",children:d.map((r,c)=>e.jsx("li",{children:r},c))}):e.jsxs("span",{className:"font-semibold",children:["âš ï¸ ",d]})}),!i&&e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-bold text-gray-700 mb-2",children:"New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:l?"text":"password",value:o,onChange:r=>u(r.target.value),required:!0,autoComplete:"new-password",className:"w-full px-4 py-3 pr-12 border-2 border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-all bg-white","aria-describedby":"password-constraints-reset"}),e.jsx("button",{type:"button",onClick:()=>N(!l),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 transition-colors","aria-label":l?"Hide password":"Show password",children:l?e.jsx(j,{}):e.jsx(y,{})})]}),e.jsx("p",{id:"password-constraints-reset",className:"text-xs text-gray-500 mt-2",children:"Min. 8 characters, uppercase, lowercase, number."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-bold text-gray-700 mb-2",children:"Confirm New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:n?"text":"password",value:p,onChange:r=>h(r.target.value),required:!0,autoComplete:"new-password",className:"w-full px-4 py-3 pr-12 border-2 border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-all bg-white"}),e.jsx("button",{type:"button",onClick:()=>P(!n),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 transition-colors","aria-label":n?"Hide confirm password":"Show confirm password",children:n?e.jsx(j,{}):e.jsx(y,{})})]})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full flex justify-center items-center bg-gradient-to-r from-red-600 to-orange-600 text-white py-4 px-6 rounded-xl font-bold text-lg hover:from-red-700 hover:to-orange-700 focus:outline-none focus:ring-4 focus:ring-red-500/50 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105 shadow-xl hover:shadow-2xl",children:f?e.jsx(R,{size:"sm",color:"text-white"}):e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Reset Password"}),e.jsx(x,{className:"text-sm"})]})})]}),!i&&e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Remembered it?"," ",e.jsxs(b,{to:"/login",className:"font-bold text-red-600 hover:text-red-700 transition-colors inline-flex items-center space-x-1 group",children:[e.jsx("span",{children:"Sign in"}),e.jsx(x,{className:"text-xs group-hover:translate-x-1 transition-transform"})]})]})})]})]})]}),e.jsx(I,{})]})};export{M as default};
